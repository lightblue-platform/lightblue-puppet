{
  "security" => {
    "security-domain" => {
      "lightblue-cert" => {
        "authentication" => {
          "classic" => {
            "login-module" => {
              "CertLdapLoginModule" => {
                "code" => "com.redhat.lightblue.rest.auth.jboss.CertLdapLoginModule",
                "flag" => "required",
                "module-options" => {
                  "password-stacking" => "useFirstPass",
                  "securityDomain" => "lightblue-cert",
                  "verifier" => "org.jboss.security.auth.certs.AnyCertVerifier",
                  "rolesProperties" => "deleted",
                  "authRoleName" => "authenticated",
                  "ldapServer" => "<%= ldap_server %>",
                  "port" => "<%= ldap_port %>",
                  "searchBase" => "<%= ldap_search_base %>",
                  "bindDn" => "<%= ldap_username %>",
                  "bindPassword" => "<%= ldap_password %>",
                  "useSSL" => "<%= ldap_use_tls %>",
                  "poolSize" => "<%= ldap_pool_size %>",
                  "trustStore" => "<%= truststore_url %>",
                  "trustStorePassword" => "<%= truststore_password %>",
                  "environment" => "<%= environment %>",
                  "debug" => "<%= @debug %>",
                  "keepAlive" => "<%= @keep_alive %>",
                  "connectionTimeoutMS" => "<%= @connection_timeout_ms %>",
                  "responseTimeoutMS" => "<%= @response_timeout_ms %>",
                  "poolMaxConnectionAgeMS" => "<%= @pool_max_connection_age_ms %>",
                }
              }
            }
          }
        },
        "jsse" => {
          "classic" => {
             "client-auth" => true,
             "keystore" => {
                        "password" => "<%= keystore_password %>",
                        "url" => "file://<%= keystore_url %>"
                    },
             "truststore" => {
                        "password" => "<%= truststore_password %>",
                        "url" => "file://<%= truststore_url %>"
                    }
            }
         }
      }
    }
  }
}
